<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Root</title>
  <link rel="icon" type="image/png" href="images/summer.png" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

  <style>
    :root{
      /* =========================
         INTRO (keep the same)
         ========================= */
      --bg:#1E2320;
      --text:#EDEBE6;

      /* =========================
         APP THEME (reference style)
         ========================= */
      --app-bg: #231815;
      --app-ink:#efe4d3;
      --app-muted: rgba(232,210,184,0.75);
      --app-muted-2: rgba(232,210,184,0.55);

      --gold-3:#e1c28a;
      --bronze-1:#a77a4d;
      --bronze-2:#7b5637;

      --shadow: 0 14px 36px rgba(0,0,0,0.55);
      --radius: 18px;
      --radius-sm: 14px;
      --max: 1040px;
    }

    *{ box-sizing:border-box; }
    html,body{ min-height:100%; }
    html{
      background:
        radial-gradient(900px 700px at 30% 10%, rgba(146,106,70,0.20), transparent 60%),
        radial-gradient(900px 700px at 90% 40%, rgba(98,69,46,0.18), transparent 60%),
        radial-gradient(1100px 900px at 50% 120%, rgba(0,0,0,0.55), transparent 55%),
        linear-gradient(180deg, #1a130f, var(--app-bg));
      background-attachment: fixed;
    }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: var(--app-ink);
      line-height: 1.35;
      overflow-y: auto;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE/Edge legacy */
      background: transparent;
    }
    body::-webkit-scrollbar{ width:0; height:0; }

    a{ color:inherit; text-decoration:none; }
    .wrap{
      max-width: var(--max);
      margin: 0 auto;
      padding: 0 18px 56px;
    }

    /* =========================
       INTRO (unchanged)
       ========================= */
    .intro{
      position: fixed;
      inset: 0;
      background: var(--bg);
      color: var(--text);
      display: grid;
      place-items: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 1800ms ease, visibility 0ms linear 1800ms;
      visibility: visible;
    }
    .intro.hide{ opacity:0; visibility:hidden; }

    .introStage{
      width: min(920px, 92vw);
      display: grid;
      place-items: center;
      row-gap: 14px;
      text-align: center;
    }
    .jp{
      font-family: "Hiragino Mincho ProN","Yu Mincho","Noto Serif JP","MS Mincho",serif;
      letter-spacing: 0.02em;
    }
    .introTree{
      width: clamp(120px, 18vw, 190px);
      opacity: 0;
      transform: translateY(6px);
      transition: opacity 1800ms ease, transform 1800ms ease;
      filter: drop-shadow(0 14px 26px rgba(0,0,0,0.45));
      user-select: none;
      -webkit-user-drag: none;
    }
    .introLine1{
      font-size: clamp(28px, 4vw, 56px);
      font-weight: 600;
      margin: 0;
      opacity: 0;
      transition: opacity 1800ms ease;
      text-shadow: 0 10px 28px rgba(0,0,0,0.45);
    }
    .introLine2{
      font-size: clamp(16px, 2.1vw, 22px);
      font-weight: 500;
      margin: 0;
      opacity: 0;
      transition: opacity 1800ms ease;
      color: rgba(237,235,230,0.85);
      text-shadow: 0 10px 28px rgba(0,0,0,0.45);
    }
    .show{ opacity:1 !important; }
    .showTree{ opacity:1 !important; transform: translateY(0) !important; }

    @media (prefers-reduced-motion: reduce){
      .intro, .introTree, .introLine1, .introLine2{ transition:none !important; }
    }

    /* =========================
       Top Bar
       ========================= */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-top: 0;
      margin-bottom: 36px;
      padding: 18px 16px 22px;
      border-radius: var(--radius);
      border: 1px solid rgba(167,122,77,0.35);
      background:
        linear-gradient(180deg, rgba(109,78,49,0.25), rgba(14,9,7,0.65)),
        radial-gradient(900px 240px at 40% 0%, rgba(167,122,77,0.22), transparent 60%),
        rgba(18,12,9,0.55);
      box-shadow: var(--shadow);
      position: sticky;
      top: 16px;
      z-index: 10;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .left{
      display:flex;
      align-items:center;
      gap:16px;
      min-width: 220px;
    }

    .userBadge{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 2px 8px 2px 2px;
      border-radius: 999px;
    }

    .avatar{
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display:grid;
      place-items:center;
      background:
        radial-gradient(60% 60% at 40% 35%, rgba(231,210,170,0.18), transparent 70%),
        linear-gradient(160deg, rgba(36,29,26,0.9), rgba(10,7,6,0.9));
      border: 1px solid rgba(239,230,214,0.2);
    }

    .avatar svg{
      width: 22px;
      height: 22px;
      opacity: 0.85;
      fill: var(--app-ink);
    }

    .userMeta{
      display:flex;
      flex-direction:column;
      line-height: 1.1;
    }

    .userName{
      font-size: 14px;
      font-weight: 700;
      color: var(--gold-3);
      letter-spacing: 0.2px;
    }

    .userAddr{
      font-size: 12px;
      color: var(--app-muted);
      font-variant-numeric: tabular-nums;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:14px;
    }

    /* Bigger icon, NO square around it */
    .logo{
      width: 80px;
      height: 80px;
      object-fit: contain;
      border: none;
      border-radius: 0;
      background: transparent;
      box-shadow: none;
      filter: drop-shadow(0 12px 20px rgba(0,0,0,0.45));
      -webkit-user-drag: none;
      user-select:none;
    }

    .brandTitle h1{
      margin:0;
      font-family: "Georgia", "Times New Roman", serif;
      font-weight: 800;
      letter-spacing: 0.2px;
      font-size: 36px;
      color: var(--gold-3);
      text-shadow: 0 10px 26px rgba(0,0,0,0.55);
      line-height: 1;
    }

    .right{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    .profileMenu{
      position: relative;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .profileBtn{
      display:flex;
      align-items:center;
      gap:8px;
      padding: 4px;
      border-radius: 999px;
      border: 1px solid rgba(239,230,214,0.14);
      background: rgba(10,7,6,0.45);
      box-shadow: 0 10px 24px rgba(0,0,0,0.35);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      cursor: pointer;
      transition: 160ms ease;
    }

    .profileBtn:hover,
    .profileBtn:focus-visible{
      border-color: rgba(231,210,170,0.45);
      background: rgba(18,12,10,0.7);
      box-shadow: 0 12px 28px rgba(0,0,0,0.45);
      transform: translateY(-1px);
    }

    .profilePanel{
      position: absolute;
      right: 0;
      top: calc(100% + 8px);
      min-width: 220px;
      padding: 10px;
      border-radius: 14px;
      border: 1px solid rgba(239,230,214,0.14);
      background: rgba(10,7,6,0.75);
      box-shadow: 0 14px 28px rgba(0,0,0,0.45);
      display:none;
      z-index: 20;
    }

    .profileMenu:hover .profilePanel,
    .profileMenu:focus-within .profilePanel{
      display:block;
    }

    .profilePanel .pill{
      background: transparent;
      border: none;
      padding: 6px 0;
      border-radius: 0;
      box-shadow: none;
    }

    .tabs{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(167,122,77,0.35);
      background: rgba(20,13,10,0.55);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.04),
        inset 0 -1px 0 rgba(0,0,0,0.6);
    }
    .tab{
      position: relative;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid transparent;
      background: transparent;
      color: rgba(232,210,184,0.8);
      font-family: "Georgia","Times New Roman",serif;
      font-weight: 650;
      letter-spacing: 0.2px;
      cursor: pointer;
      user-select: none;
      transition: 140ms ease;
    }
    .tab:hover{
      color: var(--gold-3);
      background: rgba(86,60,38,0.45);
      border-color: rgba(193,143,95,0.45);
    }
    .tab.active{
      color: var(--gold-3);
      background: rgba(104,73,45,0.65);
      border-color: rgba(209,164,110,0.6);
    }
    .tab.active::after{
      content:"";
      position:absolute;
      left: 14px;
      right: 14px;
      bottom: -8px;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(225,194,138,0.95), transparent);
      box-shadow: 0 0 16px rgba(225,194,138,0.55);
      border-radius: 999px;
    }

    .profile{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(203,180,138,0.22);
      background: rgba(0,0,0,0.18);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
      white-space: nowrap;
    }
    .profile .pill{
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(203,180,138,0.18);
      background: rgba(203,180,138,0.08);
      font-size: 12px;
      color: rgba(239,230,214,0.78);
      font-family: ui-sans-serif, system-ui;
    }
    .profile .value{
      font-size: 13px;
      font-weight: 800;
      color: var(--gold-3);
      margin-left: 6px;
      letter-spacing: 0.2px;
    }

    /* =========================
       Sub-tabs header inside pages
       ========================= */
    .page{ margin-top: 18px; display:none; }
    .page.active{ display:block; }

    .subTabs{
      margin-top: 14px;
      padding: 10px 12px;
      border-radius: var(--radius);
      border: 1px solid rgba(239,230,214,0.12);
      background:
        linear-gradient(180deg, rgba(231,210,170,0.08), rgba(0,0,0,0.20)),
        rgba(0,0,0,0.16);
      box-shadow: 0 18px 40px rgba(0,0,0,0.45);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .subTabRow{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .subTab{
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid transparent;
      background: transparent;
      color: rgba(239,230,214,0.72);
      font-family: "Georgia","Times New Roman",serif;
      font-weight: 650;
      letter-spacing: 0.2px;
      cursor: pointer;
      position: relative;
      transition: 140ms ease;
      user-select:none;
    }
    .subTab:hover{
      background: rgba(203,180,138,0.08);
      border-color: rgba(203,180,138,0.18);
      color: var(--gold-3);
    }
    .subTab.active{
      color: var(--gold-3);
      background: rgba(203,180,138,0.10);
      border-color: rgba(203,180,138,0.24);
    }
    .subTab.active::after{
      content:"";
      position:absolute;
      left: 14px;
      right: 14px;
      bottom: -8px;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(231,210,170,0.95), transparent);
      box-shadow: 0 0 16px rgba(231,210,170,0.55);
      border-radius: 999px;
    }

    .filterBtn{
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(203,180,138,0.22);
      background: rgba(0,0,0,0.20);
      color: rgba(239,230,214,0.85);
      font-family: ui-sans-serif, system-ui;
      font-weight: 650;
      cursor: pointer;
      transition: 140ms ease;
      white-space: nowrap;
    }
    .filterBtn:hover{
      transform: translateY(-1px);
      border-color: rgba(231,210,170,0.28);
      background: rgba(203,180,138,0.08);
    }

    /* Controls (search) */
    .controls{
      margin-top: 14px;
      display:flex;
      gap: 12px;
      align-items:center;
      flex-wrap: wrap;
    }
    .search{
      flex: 1 1 520px;
      display:flex;
      align-items:center;
      gap:10px;
      padding: 12px 14px;
      border-radius: 999px;
      border: 1px solid rgba(203,180,138,0.22);
      background: rgba(0,0,0,0.22);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
    }
    .search svg{ flex: 0 0 auto; opacity: 0.9; color: rgba(239,230,214,0.75); }
    .search input{
      width:100%;
      border:0;
      outline:0;
      background: transparent;
      color: var(--app-ink);
      font-size: 15px;
    }
    .tinyPill{
      flex: 0 0 auto;
      padding: 10px 12px;
      border: 1px solid rgba(167,122,77,0.35);
      background: rgba(20,13,10,0.55);
      border-radius: 999px;
      color: rgba(232,210,184,0.78);
      font-size: 13px;
      white-space: nowrap;
    }

    /* Cards (reference layout) */
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
      margin-top: 14px;
    }
    .card{
      display:grid;
      grid-template-columns: 260px 1fr 160px;
      gap: 16px;
      padding: 14px;
      border-radius: var(--radius);
      border: 1px solid rgba(167,122,77,0.35);
      background:
        linear-gradient(180deg, rgba(120,86,56,0.22), rgba(10,7,5,0.55)),
        rgba(20,13,10,0.55);
      box-shadow: 0 18px 40px rgba(0,0,0,0.50);
      position: relative;
      overflow: hidden;
    }
    .card::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(700px 220px at 15% 0%, rgba(171,125,79,0.22), transparent 55%);
      pointer-events:none;
    }

    .thumbWrap{
      border-radius: var(--radius-sm);
      border: 1px solid rgba(203,180,138,0.22);
      overflow:hidden;
      background: rgba(0,0,0,0.25);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
    }
    .thumb{
      width:100%;
      height: 150px;
      object-fit: cover;
      display:block;
      filter: saturate(0.95) contrast(1.05);
    }

    .cardMain{
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap: 8px;
      position: relative;
      z-index: 1;
    }
    .title{
      margin:0;
      font-family: "Georgia","Times New Roman",serif;
      font-size: 30px;
      font-weight: 700;
      color: var(--gold-3);
      letter-spacing: 0.2px;
      text-shadow: 0 14px 30px rgba(0,0,0,0.55);
      line-height: 1.05;
    }
    .rev{
      font-family: ui-sans-serif, system-ui;
      font-weight: 800;
      font-size: 18px;
      color: rgba(239,230,214,0.92);
    }
    .rev .unit{
      font-weight: 700;
      color: rgba(239,230,214,0.65);
      font-size: 14px;
      margin-left: 6px;
    }

    .rowStats{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px 14px;
      margin-top: 6px;
      padding-top: 10px;
      border-top: 1px solid rgba(203,180,138,0.18);
      color: rgba(239,230,214,0.78);
      font-size: 13px;
    }
    .rowStats .k{ color: rgba(239,230,214,0.62); margin-right: 10px; }
    .rowStats .v{ color: rgba(239,230,214,0.92); font-weight: 750; letter-spacing: 0.2px; }

    .cardAction{
      display:flex;
      align-items:center;
      justify-content:center;
      position: relative;
      z-index: 1;
    }
    .viewBtn{
      width: 140px;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(203,180,138,0.35);
      background: linear-gradient(180deg, rgba(239,230,214,0.78), rgba(203,180,138,0.70));
      color: #2a1d16;
      font-family: "Georgia","Times New Roman",serif;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 14px 28px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.5);
      transition: 140ms ease;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
    }
    .viewBtn:hover{ transform: translateY(-1px); }
    .caret{
      width: 0; height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 6px solid rgba(42,29,22,0.75);
      margin-top: 2px;
    }

    /* Map panel */
    .mapPanel{
      margin-top: 14px;
      border-radius: var(--radius);
      border: 1px solid rgba(167,122,77,0.35);
      overflow: hidden;
      background: rgba(20,13,10,0.6);
      box-shadow: 0 18px 40px rgba(0,0,0,0.55);
    }
    .mapHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 12px 14px;
      background: linear-gradient(180deg, rgba(120,86,56,0.24), rgba(10,7,5,0.55));
      border-bottom: 1px solid rgba(167,122,77,0.28);
      color: rgba(232,210,184,0.8);
      font-size: 13px;
    }
    .badge{
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(167,122,77,0.35);
      background: rgba(24,16,12,0.6);
      color: var(--gold-3);
      font-weight: 800;
      font-size: 12px;
      font-family: ui-sans-serif, system-ui;
      letter-spacing: 0.2px;
    }
    .mapFrame,
    #map{
      width: 100%;
      height: min(520px, 65vh);
      border: 0;
      display: block;
      filter: saturate(0.95) contrast(1.05);
    }
    .leaflet-container{
      background: #14100d;
    }

    /* Manage: single business page */
    .businessPage{
      margin-top: 14px;
      border-radius: var(--radius);
      border: 1px solid rgba(167,122,77,0.35);
      background: linear-gradient(180deg, rgba(120,86,56,0.22), rgba(10,7,5,0.55)), rgba(20,13,10,0.55);
      box-shadow: 0 18px 40px rgba(0,0,0,0.55);
      overflow:hidden;
    }
    .businessHero{
      display:grid;
      grid-template-columns: 1.3fr 1fr;
      gap: 14px;
      padding: 14px;
      border-bottom: 1px solid rgba(167,122,77,0.28);
    }
    .heroImg{
      border-radius: var(--radius-sm);
      border: 1px solid rgba(167,122,77,0.35);
      overflow:hidden;
      background: rgba(18,12,9,0.6);
      aspect-ratio: 4 / 3;
    }
    .heroImg img{
      width:100%;
      height: 100%;
      object-fit: cover;
      object-position: center 20%;
      display:block;
      filter: none;
    }
    .heroInfo{
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap: 10px;
      padding: 4px 2px;
    }
    .heroInfo h2{
      margin:0;
      font-family: "Georgia","Times New Roman",serif;
      font-size: 42px;
      color: var(--gold-3);
      text-shadow: 0 16px 34px rgba(0,0,0,0.55);
      line-height: 1.05;
    }
    .heroMeta{
      color: rgba(232,210,184,0.8);
      font-size: 14px;
    }
    .heroBadges{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 2px;
    }
    .teamList{
      margin-top: 10px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 8px 10px;
    }
    .teamTitle{
      margin-top: 12px;
      font-size: 12px;
      letter-spacing: 0.3px;
      text-transform: uppercase;
      color: rgba(232,210,184,0.65);
      font-weight: 700;
    }
    .branches{
      margin-top: 14px;
      margin-left: 14px;
      margin-right: 14px;
      padding: 14px 24px;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(203,180,138,0.18);
      background: rgba(0,0,0,0.18);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
    }
    .branchesTitle{
      margin: 0 0 10px;
      font-size: 12px;
      color: rgba(232,210,184,0.7);
      text-transform: uppercase;
      letter-spacing: 0.4px;
      font-weight: 700;
    }
    .branchList{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      padding: 0;
    }
    .branchItem{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(167,122,77,0.22);
      background: rgba(18,12,9,0.55);
      color: rgba(232,210,184,0.85);
      font-size: 12px;
      font-variant-numeric: tabular-nums;
    }
    .branchLeft{
      display:flex;
      align-items:center;
      gap: 8px;
      min-width: 0;
      overflow: hidden;
    }
    .storeIcon{
      width: 18px;
      height: 18px;
      border-radius: 6px;
      display:grid;
      place-items:center;
      background: rgba(18,12,9,0.7);
      border: 1px solid rgba(231,210,170,0.35);
      flex: 0 0 auto;
    }
    .storeIcon svg{
      width: 12px;
      height: 12px;
      fill: var(--gold-3);
      opacity: 0.85;
    }
    .branchAddr{
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .branchRoyalty{
      color: var(--gold-3);
      font-weight: 700;
      min-width: 44px;
      text-align: right;
    }
    .teamMember{
      display:grid;
      align-items:center;
      grid-template-columns: auto 1fr auto;
      column-gap: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(167,122,77,0.28);
      background: rgba(20,13,10,0.55);
      color: rgba(232,210,184,0.85);
      font-size: 12px;
      font-variant-numeric: tabular-nums;
    }
    .teamMember.highlight{
      border-color: rgba(225,194,138,0.75);
      box-shadow: 0 0 0 1px rgba(225,194,138,0.25);
    }
    .teamInfo{
      display:flex;
      align-items:center;
      gap:8px;
      min-width: 0;
      overflow: hidden;
    }
    .teamInfo span:last-child{
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .teamPct{
      color: var(--gold-3);
      font-weight: 700;
      letter-spacing: 0.2px;
      min-width: 44px;
      text-align: right;
      justify-self: end;
    }
    .anonIcon{
      width: 18px;
      height: 18px;
      border-radius: 50%;
      display:grid;
      place-items:center;
      background: rgba(18,12,9,0.7);
      border: 1px solid rgba(231,210,170,0.35);
      flex: 0 0 auto;
      position: relative;
      overflow: visible;
    }
    .anonIcon svg{
      width: 12px;
      height: 12px;
      fill: var(--gold-3);
      opacity: 0.85;
    }
    .teamMember.highlight{
      position: relative;
    }
    .teamMember.highlight::after{
      content:"";
      position:absolute;
      top: -8px;
      right: -8px;
      width: 16px;
      height: 16px;
      background: rgba(225,194,138,0.98);
      border: 1px solid rgba(42,27,18,0.85);
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.55);
      z-index: 3;
      pointer-events: none;
    }
    .teamMember.highlight::before{
      content:"";
      position:absolute;
      top: -4px;
      right: -4px;
      width: 10px;
      height: 10px;
      z-index: 4;
      background: #2a1b12;
      -webkit-mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M3 18h18l-2-10-5 5-2-7-2 7-5-5-2 10Zm4 2h10v2H7v-2Z'/></svg>") no-repeat center / contain;
      mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M3 18h18l-2-10-5 5-2-7-2 7-5-5-2 10Zm4 2h10v2H7v-2Z'/></svg>") no-repeat center / contain;
      pointer-events: none;
    }

    .heroStats{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 12px;
      padding: 14px;
    }
    .stat{
      padding: 12px 12px;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(203,180,138,0.18);
      background: rgba(0,0,0,0.18);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
    }
    .stat .label{
      color: rgba(239,230,214,0.62);
      font-size: 12px;
      margin-bottom: 6px;
    }
    .stat .value{
      font-size: 18px;
      font-weight: 850;
      letter-spacing: 0.2px;
      color: rgba(239,230,214,0.92);
    }

    .businessBody{
      padding: 0 14px 14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    .panel{
      padding: 14px;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(203,180,138,0.18);
      background: rgba(0,0,0,0.16);
    }
    .panel h3{
      margin:0 0 10px;
      font-family: "Georgia","Times New Roman",serif;
      color: var(--gold-3);
      letter-spacing: 0.2px;
      font-size: 20px;
    }
    .panelHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .panelHeader h3{
      margin:0;
    }
    .createTaskBtn{
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(167,122,77,0.35);
      background: rgba(20,13,10,0.55);
      color: var(--gold-3);
      font-family: "Georgia","Times New Roman",serif;
      font-weight: 700;
      font-size: 12px;
      cursor: pointer;
      transition: 140ms ease;
    }
    .createTaskBtn:hover{
      background: rgba(92,64,40,0.5);
      border-color: rgba(225,194,138,0.55);
      transform: translateY(-1px);
    }
    .list{
      margin:0;
      padding-left: 18px;
      color: rgba(239,230,214,0.78);
      line-height: 1.6;
      font-size: 14px;
    }
    .kv{
      display:grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      padding: 10px 0;
      border-bottom: 1px solid rgba(203,180,138,0.14);
      color: rgba(239,230,214,0.78);
      font-size: 14px;
    }
    .kv:last-child{ border-bottom:0; }
    .kv b{ color: rgba(239,230,214,0.92); font-weight: 800; }

    @media (max-width: 920px){
      .card{ grid-template-columns: 220px 1fr; }
      .cardAction{ grid-column: 1 / -1; justify-content:flex-end; }
      .businessHero{ grid-template-columns: 1fr; }
      .heroImg img{ height: auto; }
      .heroStats{ grid-template-columns: 1fr; }
      .businessBody{ grid-template-columns: 1fr; }
    }
    @media (max-width: 620px){
      .tabs{ width:100%; justify-content:space-between; }
      .profile{ width:100%; justify-content:space-between; }
      .brand{ min-width: unset; }
      .card{ grid-template-columns: 1fr; }
      .thumb{ height: 190px; }
      .cardAction{ justify-content:flex-start; }
      .logo{ width: 68px; height: 68px; }
      .brandTitle h1{ font-size: 30px; }
    }
  </style>
</head>

<body>
  <!-- INTRO (kept the same) -->
  <div class="intro" id="intro" aria-hidden="true">
    <div class="introStage">
      <img id="introTree" class="introTree" src="images/spring.png" alt="" />
      <p id="introLine1" class="introLine1 jp">森へようこそでございます</p>
      <p id="introLine2" class="introLine2 jp">夏です。</p>
    </div>
  </div>

  <div class="wrap">
    <header class="topbar">
      <div class="left">
        <div class="brand">
          <img class="logo" id="headerLogo" src="images/spring.png" alt="The Root logo" />
          <div class="brandTitle"><h1>The Root</h1></div>
        </div>
      </div>

      <div class="right">
        <nav class="tabs" aria-label="Primary">
          <button class="tab active" type="button" data-page="area">Your Area</button>
          <button class="tab" type="button" data-page="clone">Clone</button>
          <button class="tab" type="button" data-page="manage">Manage</button>
        </nav>

        <div class="profileMenu">
          <button class="profileBtn" type="button" aria-label="Profile menu">
            <div class="userBadge">
              <div class="avatar" aria-hidden="true">
                <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
                  <path d="M12 12.2a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2.3c-3.2 0-6 1.6-6 3.8v1.2h12v-1.2c0-2.2-2.8-3.8-6-3.8Z"/>
                </svg>
              </div>
              <div class="userMeta">
                <div class="userName">中本 哲史</div>
                <div class="userAddr">0x4f2a...9c1b</div>
              </div>
            </div>
          </button>

          <div class="profilePanel" role="menu" aria-label="Wallet">
            <div class="profile">
              <div class="pill">Wallet <span class="value">Ξ2.1621</span></div>
              <div class="pill">Debt Allowance <span class="value">Ξ1</span></div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- ===================== PAGE: YOUR AREA ===================== -->
    <main class="page active" id="page-area" aria-label="Your Area">
      <div class="mapPanel">
        <div class="mapHeader">
          <div style="display:flex; gap:10px; align-items:center;">
            <span class="badge">Tokyo</span>
            <span>Map view (OpenStreetMap embed)</span>
          </div>
          <span class="badge">Static</span>
        </div>

        <div id="map" role="img" aria-label="Tokyo Map"></div>
      </div>
    </main>

    <!-- ===================== PAGE: CLONE ===================== -->
    <main class="page" id="page-clone" aria-label="Clone">
      <div class="controls">
        <div class="search" role="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="2" opacity="0.85"/>
            <path d="M16.5 16.5 21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.85"/>
          </svg>
          <input id="search" type="search" placeholder="Search businesses…" autocomplete="off" />
        </div>

        <div class="tinyPill">Assumed 1 ETH ≈ $3,000</div>
      </div>

      <section class="grid" id="cards">
        <article class="card" data-name="coffee shop cafe">
          <div class="thumbWrap"><img class="thumb" src="images/spring.png" alt="Coffee Shop" /></div>
          <div class="cardMain">
            <h3 class="title">Cafe Nakamoto</h3>
            <div class="rev">Ξ73.33 <span class="unit">/ year</span></div>
            <div class="rowStats">
              <div><span class="k">Minimal starting</span><span class="v">Ξ13.33</span></div>
              <div><span class="k">Avg. operation</span><span class="v">Ξ20.00 / year</span></div>
            </div>
          </div>
          <div class="cardAction"><button class="viewBtn" type="button">View <span class="caret"></span></button></div>
        </article>

        <article class="card" data-name="pet grooming salon">
          <div class="thumbWrap"><img class="thumb" src="images/fall.png" alt="Pet Grooming" /></div>
          <div class="cardMain">
            <h3 class="title">Pet Grooming</h3>
            <div class="rev">Ξ61.67 <span class="unit">/ year</span></div>
            <div class="rowStats">
              <div><span class="k">Minimal starting</span><span class="v">Ξ5.67</span></div>
              <div><span class="k">Avg. operation</span><span class="v">Ξ18.33 / year</span></div>
            </div>
          </div>
          <div class="cardAction"><button class="viewBtn" type="button">View <span class="caret"></span></button></div>
        </article>

        <article class="card" data-name="plant nursery garden">
          <div class="thumbWrap"><img class="thumb" src="images/summer.png" alt="Plant Nursery" /></div>
          <div class="cardMain">
            <h3 class="title">Plant Nursery</h3>
            <div class="rev">Ξ68.33 <span class="unit">/ year</span></div>
            <div class="rowStats">
              <div><span class="k">Minimal starting</span><span class="v">Ξ8.33</span></div>
              <div><span class="k">Avg. operation</span><span class="v">Ξ21.00 / year</span></div>
            </div>
          </div>
          <div class="cardAction"><button class="viewBtn" type="button">View <span class="caret"></span></button></div>
        </article>

        <article class="card" data-name="ice cream shop dessert">
          <div class="thumbWrap"><img class="thumb" src="images/winter.png" alt="Ice Cream Shop" /></div>
          <div class="cardMain">
            <h3 class="title">Ice Cream Shop</h3>
            <div class="rev">Ξ73.33 <span class="unit">/ year</span></div>
            <div class="rowStats">
              <div><span class="k">Minimal starting</span><span class="v">Ξ8.33</span></div>
              <div><span class="k">Avg. operation</span><span class="v">Ξ21.00 / year</span></div>
            </div>
          </div>
          <div class="cardAction"><button class="viewBtn" type="button">View <span class="caret"></span></button></div>
        </article>
      </section>
    </main>

    <!-- ===================== PAGE: MANAGE ===================== -->
    <main class="page" id="page-manage" aria-label="Manage">
      <section class="businessPage">
        <div class="businessHero">
          <div class="heroImg">
            <img src="images/cafe-minimal.png" alt="Cafe Nakamoto" />
          </div>
          <div class="heroInfo">
            <h2>Cafe Nakamoto</h2>
            <div class="heroMeta">Status: Operating · Location: Shinjuku, Tokyo · Category: Café</div>
            <div class="heroBadges">
              <span class="badge">Shinjuku</span>
              <span class="badge">Open</span>
              <span class="badge">Team: 6</span>
            </div>
            <div class="teamTitle">Team Members</div>
            <div class="teamList" aria-label="Team members">
              <div class="teamMember highlight">
                <span class="teamInfo">
                  <span class="anonIcon" aria-hidden="true">
                    <svg viewBox="0 0 24 24"><path d="M12 12.2a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2.3c-3.2 0-6 1.6-6 3.8v1.2h12v-1.2c0-2.2-2.8-3.8-6-3.8Z"/></svg>
                  </span>
                  0x4f2a...9c1b
                </span>
                <span class="teamPct">34%</span>
              </div>
              <div class="teamMember">
                <span class="teamInfo">
                  <span class="anonIcon" aria-hidden="true">
                    <svg viewBox="0 0 24 24"><path d="M12 12.2a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2.3c-3.2 0-6 1.6-6 3.8v1.2h12v-1.2c0-2.2-2.8-3.8-6-3.8Z"/></svg>
                  </span>
                  0x8c31...a92f
                </span>
                <span class="teamPct">16%</span>
              </div>
              <div class="teamMember">
                <span class="teamInfo">
                  <span class="anonIcon" aria-hidden="true">
                    <svg viewBox="0 0 24 24"><path d="M12 12.2a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2.3c-3.2 0-6 1.6-6 3.8v1.2h12v-1.2c0-2.2-2.8-3.8-6-3.8Z"/></svg>
                  </span>
                  0x1f7b...c4e2
                </span>
                <span class="teamPct">15%</span>
              </div>
              <div class="teamMember">
                <span class="teamInfo">
                  <span class="anonIcon" aria-hidden="true">
                    <svg viewBox="0 0 24 24"><path d="M12 12.2a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2.3c-3.2 0-6 1.6-6 3.8v1.2h12v-1.2c0-2.2-2.8-3.8-6-3.8Z"/></svg>
                  </span>
                  0x5a9d...11b6
                </span>
                <span class="teamPct">13%</span>
              </div>
              <div class="teamMember">
                <span class="teamInfo">
                  <span class="anonIcon" aria-hidden="true">
                    <svg viewBox="0 0 24 24"><path d="M12 12.2a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2.3c-3.2 0-6 1.6-6 3.8v1.2h12v-1.2c0-2.2-2.8-3.8-6-3.8Z"/></svg>
                  </span>
                  0x92de...7c40
                </span>
                <span class="teamPct">12%</span>
              </div>
              <div class="teamMember">
                <span class="teamInfo">
                  <span class="anonIcon" aria-hidden="true">
                    <svg viewBox="0 0 24 24"><path d="M12 12.2a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2.3c-3.2 0-6 1.6-6 3.8v1.2h12v-1.2c0-2.2-2.8-3.8-6-3.8Z"/></svg>
                  </span>
                  0x0b4f...e18a
                </span>
                <span class="teamPct">10%</span>
              </div>
            </div>

          </div>
        </div>

        <div class="branches">
          <h3 class="branchesTitle">Active Branches · Royalties</h3>
          <div class="branchList" aria-label="Active branches">
            <div class="branchItem">
              <span class="branchLeft">
                <span class="storeIcon" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M4 7h16l-1.5 4H5.5L4 7Zm1 6h14v6H5v-6Zm4 1v4h2v-4H9Zm4 0v4h2v-4h-2Z"/></svg>
                </span>
                <span class="branchAddr">0xa3f1...c77b</span>
              </span>
              <span class="branchRoyalty">1.9% royalty</span>
            </div>
            <div class="branchItem">
              <span class="branchLeft">
                <span class="storeIcon" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M4 7h16l-1.5 4H5.5L4 7Zm1 6h14v6H5v-6Zm4 1v4h2v-4H9Zm4 0v4h2v-4h-2Z"/></svg>
                </span>
                <span class="branchAddr">0x5d9c...10fa</span>
              </span>
              <span class="branchRoyalty">1.6% royalty</span>
            </div>
            <div class="branchItem">
              <span class="branchLeft">
                <span class="storeIcon" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M4 7h16l-1.5 4H5.5L4 7Zm1 6h14v6H5v-6Zm4 1v4h2v-4H9Zm4 0v4h2v-4h-2Z"/></svg>
                </span>
                <span class="branchAddr">0x9b42...7e0d</span>
              </span>
              <span class="branchRoyalty">1.3% royalty</span>
            </div>
            <div class="branchItem">
              <span class="branchLeft">
                <span class="storeIcon" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M4 7h16l-1.5 4H5.5L4 7Zm1 6h14v6H5v-6Zm4 1v4h2v-4H9Zm4 0v4h2v-4h-2Z"/></svg>
                </span>
                <span class="branchAddr">0x1c8e...a2b9</span>
              </span>
              <span class="branchRoyalty">1.1% royalty</span>
            </div>
            <div class="branchItem">
              <span class="branchLeft">
                <span class="storeIcon" aria-hidden="true">
                  <svg viewBox="0 0 24 24"><path d="M4 7h16l-1.5 4H5.5L4 7Zm1 6h14v6H5v-6Zm4 1v4h2v-4H9Zm4 0v4h2v-4h-2Z"/></svg>
                </span>
                <span class="branchAddr">0x7aa1...f8c2</span>
              </span>
              <span class="branchRoyalty">0.8% royalty</span>
            </div>
          </div>
        </div>

        <div class="heroStats">
          <div class="stat">
            <div class="label">Monthly revenue</div>
            <div class="value">Ξ5.20</div>
          </div>
          <div class="stat">
            <div class="label">Monthly operating cost</div>
            <div class="value">Ξ3.10</div>
          </div>
          <div class="stat">
            <div class="label">Next payroll</div>
            <div class="value">Ξ0.42</div>
          </div>
        </div>

        <div class="businessBody">
          <div class="panel">
            <h3>Operations</h3>
            <div class="kv"><span>Open hours</span><b>08:00–20:00</b></div>
            <div class="kv"><span>Average hourly income</span><b>Ξ0.028</b></div>
            <div class="kv"><span>Expenditure Reserve</span><b>Ξ1.25</b></div>
          </div>

          <div class="panel">
            <div class="panelHeader">
              <h3>Ruleset Change</h3>
              <button class="createTaskBtn" type="button">Create Task</button>
            </div>
            <ul class="list">
              <li>Switch bean supplier to Yumenosora Roasters (0x7b3e...c9a1) — effective Mar 1</li>
              <li>Adjust house blend recipe: +5% Colombia, -5% Ethiopia</li>
              <li>Update milk options: add oat blend, discontinue soy</li>
              <li>Revise closing procedure checklist for grinder cleaning</li>
            </ul>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script>
    (function(){
      /* ===== Seasonal logic (system time) ===== */
      function getSeason(month){
        if (month >= 2 && month <= 4) return "spring";
        if (month >= 5 && month <= 7) return "summer";
        if (month >= 8 && month <= 10) return "fall";
        return "winter";
      }

      const seasonText = {
        spring: "春です。",
        summer: "夏です。",
        fall:   "秋です。",
        winter: "冬です。"
      };

      const seasonImage = {
        spring: "images/spring.png",
        summer: "images/summer.png",
        fall:   "images/fall.png",
        winter: "images/winter.png"
      };

      const season = getSeason(new Date().getMonth());

      document.getElementById('introLine2').textContent = seasonText[season] || "夏です。";
      document.getElementById('introTree').src = seasonImage[season] || "images/spring.png";
      document.getElementById('headerLogo').src = seasonImage[season] || "images/spring.png";

      /* ===== Intro sequence (0.75x, tree lingers longer) ===== */
      const intro = document.getElementById('intro');
      const line1 = document.getElementById('introLine1');
      const tree  = document.getElementById('introTree');
      const line2 = document.getElementById('introLine2');

      if (sessionStorage.getItem('root_intro_seen')) {
        intro.classList.add('hide');
      } else {
        sessionStorage.setItem('root_intro_seen','1');

        const t = { show1: 90, showTree: 675, show2: 1875, done: 2700 };

        setTimeout(() => line1.classList.add('show'), t.show1);
        setTimeout(() => tree.classList.add('showTree'), t.showTree);
        setTimeout(() => line2.classList.add('show'), t.show2);
        setTimeout(() => intro.classList.add('hide'), t.done);
      }

      /* ===== Tabs operational ===== */
      const tabs = Array.from(document.querySelectorAll('.tab[data-page]'));
      const pages = {
        area: document.getElementById('page-area'),
        clone: document.getElementById('page-clone'),
        manage: document.getElementById('page-manage')
      };

      function setActive(pageKey){
        tabs.forEach(t => t.classList.toggle('active', t.dataset.page === pageKey));
        Object.keys(pages).forEach(k => pages[k].classList.toggle('active', k === pageKey));
      }
      tabs.forEach(t => t.addEventListener('click', () => setActive(t.dataset.page)));

      /* ===== Search filter (Clone tab) ===== */
      const search = document.getElementById('search');
      const cards = Array.from(document.querySelectorAll('#cards .card'));
      function applyFilter(q){
        const query = q.trim().toLowerCase();
        cards.forEach(card => {
          const name = (card.getAttribute('data-name') || '').toLowerCase();
          card.style.display = (!query || name.includes(query)) ? '' : 'none';
        });
      }
      if (search) search.addEventListener('input', (e) => applyFilter(e.target.value));

      /* ===== Map (Leaflet) ===== */
      const map = L.map("map", {
        zoomControl: true,
        attributionControl: true
      }).setView([35.640126, 139.921591], 18);

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 20,
        attribution: "&copy; OpenStreetMap contributors"
      }).addTo(map);

      L.marker([35.640126, 139.921591]).addTo(map);

    })();
  </script>
</body>
</html>
